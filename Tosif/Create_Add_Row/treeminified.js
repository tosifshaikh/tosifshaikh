function callAjax(){var a=$("<td>").append($("<input>").attr({type:"button",id:"rootBtn",onclick:"addNodes(0,0,0,0)",value:"Add Root"}));$("#mytable").append($("<tr>").append(a).attr("id","tr"+rowId)),dataPrint(0,1)}function dataPrint(a,t){var e=1;for(var r in data[a]){n=numGenerator(a,t,e);for(var d=0;l>=d;d++)d==l&&createRow(r,a,n,rowId,d);rowId=r,len++,l++,e++,dataPrint(r,n),l--,0==a&&(l=0,t++)}}function createRow(a,t,e,r,d){for(var n="",o=0;d>o;o++)n+="<td></td>";arr.push(data[t][a]);var i=$("<span>").attr({id:"span"+a}).text(e),l=$("<span>").attr({id:"nmspan"+a}).text(data[t][a]),p=$("<button>").attr({id:"btn"+a,onclick:"addNodes("+a+","+t+","+(o+1)+")"}).text("Add"),c=$("<button>").attr({id:"edit"+a,onclick:"editNodes("+a+","+t+")"}).text("Edit"),s=$("<button>").attr({id:"del"+a,onclick:"delNodes("+a+","+t+","+o+")"}).text("Delete"),u=$("<td>").append(i,"   ",l,p,c,s).attr("id","id"+a);$("<tr>").append(n,u).insertAfter("#tr"+r).attr("id","tr"+a)}function addNodes(a,t,e){pid=t,cid=a,indx=$("#span"+cid).text(),space=e,promBox=prompt("enter name"),null!=promBox&&(flag=1,save())}function editNodes(a,t){pid=t,cid=a,promBox=prompt("enter name",data[pid][cid]),null!=promBox&&(flag=2,save())}function delNodes(a,t){for(var e in data[a])delNodes(e,a);delete data[t][a],$("#tr"+a).remove(),del(t)}function del(a){var t=1;for(var e in data[a])newNum=0==a?numGenerator(a,t,t):numGenerator(a,$("#span"+a).text(),t),t++,$("#span"+e).text(newNum),del(e)}function validate(a,t){if(""==a)return alert("blank not allowed"),!1;if(/[^a-zA-Z0-9\-\_\/]/.test(a))return alert("special characters are not allowed"),!1;for(var e in data[t])if(data[t][e].toLowerCase()==a.toLowerCase())return alert("same values are not allowed"),!1}function save(){val=promBox.trim();var a=arr.length+1;if(1==flag){var t=validate(val,cid);if(0==t)promBox=prompt("enter name","");else{var e=lastValue(pid,cid);if(0==e[1]){data[cid]={},data[cid][a]=val;var r=cid}else{var r=e[0];data[cid][a]=val}if(0==cid){space=0;var d=numGenerator(0,e[1]+1,indx)}else var d=numGenerator(a,indx,e[1]+1);var r=e[2];alert("New Row Added"),createRow(a,cid,d,r,space)}}else if(2==flag){var t=validate(val,pid);0==t?promBox=prompt("enter name",""):(alert("value is changed : "+val),data[pid][cid]=val,$("#nmspan"+cid).html(data[pid][cid]))}}function lastValue(a,t){var e=0,r=[];pos=t;for(var d in data[t])e++,pos=d,lastValue(t,d);return r.push(d,e,pos),r}function numGenerator(a,t,e){return num=0==a?t:t+"."+e}var data,z,l=0,num,n,flag,val,len=0,indx,space,pos,promBox,newNum,url="treeJson1.php",rowId=0,pid,cid,arr=[];$(document).ready(function(){$.ajax({type:"GET",url:url,dataType:"json",success:function(a){data=a,callAjax()}})});